"use strict";(self.webpackChunkgulp2024=self.webpackChunkgulp2024||[]).push([[1],{1:(e,r,t)=>{t.r(r),t.d(r,{default:()=>n});var s=t(922),a=t(212),i=t(514),o=t(320);const n=class{constructor(e){this.options=Object.assign({wrapperSelector:".content-authorization",redirect:null,onAuth:()=>{}},e),this.wrapper=document.querySelector(this.options.wrapperSelector),this.urlParams=new URLSearchParams(window.location.search),this.form=document.querySelector(".form-authorization"),this.form&&(this.validator=(0,o.V)(this.form),this.loader=new s.a(this.wrapper),this.isAuth=!1,this.resData=null,this.username=this.urlParams.get("username"),this.username&&(this.form.querySelector('input[name="username"]').value=this.username.slice(1)),this.events())}events(){this.form&&this.form.addEventListener("submit",this.submit.bind(this))}submit(){if(!this.validator.isValid)return;const e=new FormData(this.form);e.set("username",e.get("username").replace(/[+() -]/g,"")),this.auth(e)}async auth(e){try{this.loader.enable();const r=await a.Ay.post("/_login_",e);if(200!==r.status)return;const{msg:t,msg_type:s,access_token:o,expiration_time:n}=this.resData=r.data;(0,i.G)(r.data),"success"===s&&(this.isAuth=!0,document.cookie=`token=Bearer ${o}; max-age=${n}; path=/`,this.options.onAuth(),this.options.redirect&&(document.location.pathname=this.options.redirect))}catch(e){console.error("Ошибка при регистрации",e.message)}finally{this.loader.disable()}}}},320:(e,r,t)=>{t.d(r,{V:()=>i,n:()=>o});var s=t(482),a=t(660);function i(e){if(!e)return;const r=new s.Ay(e,{errorLabelStyle:{color:"#FF0505"}}),t=e.querySelector('input[name="username"]');return a.default("+7 (999) 999-99-99").mask(t),r.addField(e.querySelector('input[name="username"]'),[{rule:"required",errorMessage:"Введите телефон"},{validator:e=>{const r=a.default.unmask(e,{mask:"+7 (999) 999-99-99"});return Boolean(Number(r)&&10===r.length)},errorMessage:"Неверный формат"}]).addField(e.querySelector('input[name="password"]'),[{rule:"required",errorMessage:"Введите пароль"},{rule:"minLength",value:6,errorMessage:"Пароль должен содержать минимум 6 символов"}]),r}function o(e){if(!e)return;const r=new s.Ay(e,{errorLabelStyle:{color:"#FF0505"}});return r.addField(e.querySelector('input[name="email"]'),[{rule:"required",errorMessage:"Введите почту"},{rule:"email",errorMessage:"Неверный формат"}]).addField(e.querySelector('input[name="password"]'),[{rule:"required",errorMessage:"Введите пароль"},{rule:"minLength",value:6,errorMessage:"Пароль должен содержать минимум 6 символов"}]).addField(e.querySelector('input[name="repassword"]'),[{rule:"required",errorMessage:"Повторите пароль"},{validator:r=>r===e.querySelector('input[name="password"]').value,errorMessage:"Пароли не совпадают"}]).addField(e.querySelector('input[name="privacy_policy"]'),[{rule:"required"}]),r}}}]);